#include "reconos_thread.h"
#include "reconos_calls.h"

#include "ap_int.h"
#include "ap_fixed.h"

// definitions of stewart platform

// coordinates of platform joints in base coordinates
ap_int<10> p_p_j_x[6] = {51,-51,-64,-13,13,64};
ap_int<10> p_p_j_y[6] = {44,44,22,-66,-66,22};

// transformation to base coordinates
ap_int<10> t_p2b_t_z = 80 + 21;

// transformation to servo coordinates
ap_fixed<10,2> t_b2s_rz_sin[6] = {0.00000000,0.00000000,0.86602540,0.86602540,-0.86602540,-0.86602540};
ap_fixed<10,2> t_b2s_rz_cos[6] = {1.00000000,1.00000000,-0.50000000,-0.50000000,-0.50000000,-0.50000000};
ap_int<10> t_b2s_s_x[6] = {-1,1,-1,1,-1,1};
ap_int<10> t_b2s_s_y[6] = {1,1,1,1,1,1};
ap_int<10> t_b2s_s_z[6] = {1,-1,1,-1,1,-1};
ap_int<10> t_b2s_t_x = 33;
ap_int<10> t_b2s_t_y = -69;
ap_int<10> t_b2s_t_z = 0;

// leg and arm lengths
ap_int<10> c_leg = 115;
ap_int<20> c_legs = 115 * 115;
ap_int<10> c_arm = 20;

// sine and cosine lookup tables
#define TRIG_COUNT 2048
#define TRIG_ADDR 11
#define TRIG_MIN_ANGLE_DEG 0
#define TRIG_MAX_ANGLE_DEG 184.32
ap_fixed<10,2> sin_lut[2048] = {0.00000000,0.00157156,0.00314312,0.00471467,0.00628621,0.00785774,0.00942924,0.01100072,0.01257218,0.01414360,0.01571499,0.01728634,0.01885765,0.02042891,0.02200012,0.02357127,0.02514237,0.02671340,0.02828437,0.02985527,0.03142610,0.03299685,0.03456751,0.03613809,0.03770859,0.03927899,0.04084929,0.04241949,0.04398958,0.04555957,0.04712945,0.04869920,0.05026884,0.05183836,0.05340774,0.05497700,0.05654612,0.05811509,0.05968393,0.06125262,0.06282115,0.06438953,0.06595776,0.06752582,0.06909371,0.07066143,0.07222898,0.07379635,0.07536353,0.07693054,0.07849735,0.08006396,0.08163038,0.08319660,0.08476261,0.08632841,0.08789400,0.08945938,0.09102453,0.09258945,0.09415415,0.09571862,0.09728285,0.09884683,0.10041058,0.10197407,0.10353732,0.10510031,0.10666304,0.10822550,0.10978770,0.11134963,0.11291128,0.11447266,0.11603375,0.11759455,0.11915506,0.12071528,0.12227521,0.12383482,0.12539414,0.12695314,0.12851183,0.13007021,0.13162826,0.13318598,0.13474338,0.13630045,0.13785717,0.13941356,0.14096961,0.14252530,0.14408064,0.14563563,0.14719026,0.14874452,0.15029842,0.15185195,0.15340510,0.15495787,0.15651026,0.15806226,0.15961387,0.16116509,0.16271591,0.16426633,0.16581634,0.16736594,0.16891513,0.17046390,0.17201225,0.17356018,0.17510768,0.17665474,0.17820137,0.17974756,0.18129330,0.18283860,0.18438345,0.18592784,0.18747177,0.18901523,0.19055824,0.19210077,0.19364282,0.19518440,0.19672549,0.19826610,0.19980622,0.20134585,0.20288498,0.20442361,0.20596173,0.20749934,0.20903645,0.21057303,0.21210910,0.21364464,0.21517965,0.21671414,0.21824808,0.21978149,0.22131436,0.22284668,0.22437845,0.22590966,0.22744032,0.22897041,0.23049994,0.23202890,0.23355729,0.23508510,0.23661233,0.23813897,0.23966503,0.24119049,0.24271536,0.24423963,0.24576330,0.24728636,0.24880881,0.25033064,0.25185186,0.25337245,0.25489242,0.25641176,0.25793046,0.25944853,0.26096596,0.26248274,0.26399888,0.26551436,0.26702919,0.26854335,0.27005686,0.27156969,0.27308186,0.27459335,0.27610417,0.27761430,0.27912374,0.28063250,0.28214057,0.28364793,0.28515460,0.28666056,0.28816581,0.28967036,0.29117418,0.29267729,0.29417968,0.29568133,0.29718226,0.29868246,0.30018191,0.30168063,0.30317860,0.30467582,0.30617229,0.30766800,0.30916295,0.31065714,0.31215056,0.31364321,0.31513509,0.31662619,0.31811650,0.31960603,0.32109477,0.32258272,0.32406987,0.32555622,0.32704177,0.32852651,0.33001044,0.33149355,0.33297584,0.33445731,0.33593796,0.33741777,0.33889676,0.34037490,0.34185220,0.34332866,0.34480428,0.34627904,0.34775294,0.34922599,0.35069817,0.35216949,0.35363994,0.35510951,0.35657821,0.35804603,0.35951296,0.36097900,0.36244416,0.36390841,0.36537177,0.36683423,0.36829578,0.36975642,0.37121615,0.37267496,0.37413285,0.37558982,0.37704586,0.37850096,0.37995514,0.38140837,0.38286066,0.38431201,0.38576241,0.38721185,0.38866034,0.39010787,0.39155443,0.39300003,0.39444466,0.39588831,0.39733099,0.39877268,0.40021339,0.40165311,0.40309184,0.40452957,0.40596631,0.40740204,0.40883676,0.41027048,0.41170318,0.41313487,0.41456553,0.41599517,0.41742379,0.41885137,0.42027792,0.42170343,0.42312790,0.42455132,0.42597369,0.42739502,0.42881529,0.43023449,0.43165264,0.43306972,0.43448573,0.43590067,0.43731453,0.43872731,0.44013900,0.44154961,0.44295913,0.44436756,0.44577488,0.44718111,0.44858623,0.44999025,0.45139315,0.45279494,0.45419561,0.45559515,0.45699358,0.45839087,0.45978703,0.46118206,0.46257594,0.46396869,0.46536029,0.46675074,0.46814003,0.46952817,0.47091515,0.47230097,0.47368562,0.47506910,0.47645141,0.47783254,0.47921249,0.48059126,0.48196884,0.48334523,0.48472043,0.48609443,0.48746723,0.48883882,0.49020921,0.49157839,0.49294635,0.49431309,0.49567862,0.49704292,0.49840599,0.49976783,0.50112844,0.50248781,0.50384593,0.50520282,0.50655845,0.50791284,0.50926597,0.51061784,0.51196845,0.51331780,0.51466588,0.51601269,0.51735822,0.51870248,0.52004545,0.52138714,0.52272755,0.52406666,0.52540448,0.52674099,0.52807621,0.52941013,0.53074273,0.53207403,0.53340401,0.53473268,0.53606002,0.53738604,0.53871073,0.54003410,0.54135612,0.54267682,0.54399617,0.54531417,0.54663083,0.54794615,0.54926010,0.55057270,0.55188394,0.55319382,0.55450233,0.55580948,0.55711524,0.55841964,0.55972265,0.56102428,0.56232453,0.56362339,0.56492085,0.56621692,0.56751159,0.56880486,0.57009673,0.57138719,0.57267623,0.57396386,0.57525008,0.57653487,0.57781824,0.57910018,0.58038069,0.58165977,0.58293741,0.58421361,0.58548837,0.58676169,0.58803355,0.58930396,0.59057292,0.59184041,0.59310645,0.59437102,0.59563412,0.59689575,0.59815591,0.59941459,0.60067179,0.60192751,0.60318174,0.60443448,0.60568572,0.60693548,0.60818373,0.60943048,0.61067572,0.61191946,0.61316168,0.61440239,0.61564159,0.61687926,0.61811541,0.61935003,0.62058312,0.62181468,0.62304471,0.62427319,0.62550014,0.62672554,0.62794939,0.62917169,0.63039243,0.63161162,0.63282925,0.63404532,0.63525982,0.63647275,0.63768411,0.63889389,0.64010210,0.64130873,0.64251377,0.64371722,0.64491909,0.64611936,0.64731804,0.64851511,0.64971059,0.65090446,0.65209672,0.65328738,0.65447642,0.65566384,0.65684964,0.65803382,0.65921638,0.66039731,0.66157660,0.66275427,0.66393029,0.66510468,0.66627742,0.66744852,0.66861797,0.66978577,0.67095191,0.67211640,0.67327923,0.67444039,0.67559989,0.67675772,0.67791388,0.67906836,0.68022117,0.68137229,0.68252174,0.68366949,0.68481556,0.68595994,0.68710263,0.68824361,0.68938290,0.69052048,0.69165636,0.69279053,0.69392299,0.69505374,0.69618277,0.69731008,0.69843567,0.69955953,0.70068166,0.70180207,0.70292074,0.70403767,0.70515287,0.70626632,0.70737803,0.70848800,0.70959621,0.71070267,0.71180738,0.71291032,0.71401151,0.71511093,0.71620859,0.71730448,0.71839859,0.71949093,0.72058150,0.72167028,0.72275729,0.72384251,0.72492594,0.72600757,0.72708742,0.72816547,0.72924172,0.73031618,0.73138882,0.73245966,0.73352870,0.73459592,0.73566132,0.73672491,0.73778668,0.73884663,0.73990475,0.74096105,0.74201551,0.74306814,0.74411894,0.74516790,0.74621502,0.74726029,0.74830372,0.74934531,0.75038504,0.75142292,0.75245894,0.75349310,0.75452540,0.75555584,0.75658442,0.75761112,0.75863595,0.75965891,0.76068000,0.76169920,0.76271653,0.76373197,0.76474552,0.76575718,0.76676696,0.76777484,0.76878082,0.76978490,0.77078709,0.77178737,0.77278574,0.77378221,0.77477676,0.77576940,0.77676012,0.77774893,0.77873582,0.77972078,0.78070381,0.78168492,0.78266410,0.78364134,0.78461665,0.78559002,0.78656145,0.78753094,0.78849848,0.78946408,0.79042772,0.79138941,0.79234915,0.79330694,0.79426276,0.79521662,0.79616851,0.79711845,0.79806641,0.79901240,0.79995641,0.80089846,0.80183852,0.80277660,0.80371270,0.80464682,0.80557894,0.80650908,0.80743723,0.80836338,0.80928754,0.81020969,0.81112985,0.81204800,0.81296415,0.81387829,0.81479041,0.81570053,0.81660863,0.81751472,0.81841878,0.81932083,0.82022085,0.82111884,0.82201481,0.82290875,0.82380065,0.82469052,0.82557835,0.82646415,0.82734790,0.82822961,0.82910927,0.82998689,0.83086246,0.83173597,0.83260743,0.83347683,0.83434418,0.83520946,0.83607268,0.83693384,0.83779293,0.83864995,0.83950490,0.84035777,0.84120857,0.84205730,0.84290394,0.84374850,0.84459098,0.84543137,0.84626967,0.84710588,0.84794000,0.84877203,0.84960196,0.85042979,0.85125552,0.85207915,0.85290067,0.85372009,0.85453740,0.85535260,0.85616569,0.85697666,0.85778551,0.85859225,0.85939686,0.86019936,0.86099973,0.86179797,0.86259408,0.86338807,0.86417992,0.86496963,0.86575721,0.86654266,0.86732596,0.86810712,0.86888613,0.86966300,0.87043772,0.87121030,0.87198072,0.87274898,0.87351509,0.87427905,0.87504084,0.87580047,0.87655794,0.87731325,0.87806639,0.87881736,0.87956616,0.88031278,0.88105724,0.88179951,0.88253961,0.88327753,0.88401327,0.88474682,0.88547819,0.88620737,0.88693436,0.88765917,0.88838178,0.88910219,0.88982041,0.89053644,0.89125026,0.89196188,0.89267130,0.89337851,0.89408352,0.89478632,0.89548691,0.89618529,0.89688145,0.89757540,0.89826713,0.89895665,0.89964394,0.90032901,0.90101186,0.90169248,0.90237088,0.90304705,0.90372098,0.90439269,0.90506216,0.90572939,0.90639439,0.90705715,0.90771767,0.90837595,0.90903198,0.90968577,0.91033732,0.91098661,0.91163365,0.91227845,0.91292099,0.91356127,0.91419930,0.91483507,0.91546858,0.91609983,0.91672882,0.91735554,0.91798000,0.91860219,0.91922211,0.91983976,0.92045514,0.92106825,0.92167908,0.92228763,0.92289391,0.92349791,0.92409962,0.92469906,0.92529621,0.92589107,0.92648365,0.92707394,0.92766194,0.92824765,0.92883107,0.92941219,0.92999102,0.93056755,0.93114178,0.93171371,0.93228334,0.93285067,0.93341570,0.93397841,0.93453883,0.93509693,0.93565273,0.93620621,0.93675738,0.93730624,0.93785278,0.93839701,0.93893892,0.93947851,0.94001578,0.94055073,0.94108335,0.94161365,0.94214163,0.94266727,0.94319059,0.94371158,0.94423024,0.94474657,0.94526057,0.94577223,0.94628155,0.94678854,0.94729318,0.94779549,0.94829546,0.94879309,0.94928837,0.94978131,0.95027190,0.95076014,0.95124604,0.95172959,0.95221078,0.95268963,0.95316612,0.95364026,0.95411204,0.95458147,0.95504854,0.95551325,0.95597560,0.95643558,0.95689321,0.95734847,0.95780137,0.95825191,0.95870007,0.95914587,0.95958930,0.96003036,0.96046905,0.96090536,0.96133931,0.96177088,0.96220007,0.96262689,0.96305133,0.96347339,0.96389307,0.96431037,0.96472529,0.96513782,0.96554798,0.96595574,0.96636113,0.96676412,0.96716473,0.96756295,0.96795878,0.96835222,0.96874326,0.96913192,0.96951818,0.96990204,0.97028351,0.97066259,0.97103927,0.97141354,0.97178542,0.97215490,0.97252198,0.97288666,0.97324893,0.97360880,0.97396627,0.97432132,0.97467398,0.97502422,0.97537206,0.97571749,0.97606051,0.97640112,0.97673931,0.97707510,0.97740847,0.97773943,0.97806797,0.97839410,0.97871781,0.97903910,0.97935797,0.97967443,0.97998847,0.98030008,0.98060928,0.98091605,0.98122040,0.98152233,0.98182183,0.98211891,0.98241356,0.98270579,0.98299559,0.98328296,0.98356790,0.98385041,0.98413050,0.98440815,0.98468337,0.98495616,0.98522652,0.98549444,0.98575993,0.98602298,0.98628360,0.98654179,0.98679753,0.98705084,0.98730172,0.98755015,0.98779614,0.98803970,0.98828081,0.98851949,0.98875572,0.98898951,0.98922086,0.98944976,0.98967622,0.98990024,0.99012181,0.99034093,0.99055761,0.99077185,0.99098363,0.99119297,0.99139986,0.99160431,0.99180630,0.99200584,0.99220294,0.99239758,0.99258977,0.99277951,0.99296680,0.99315164,0.99333402,0.99351395,0.99369143,0.99386645,0.99403901,0.99420913,0.99437678,0.99454198,0.99470473,0.99486502,0.99502285,0.99517822,0.99533113,0.99548159,0.99562959,0.99577513,0.99591821,0.99605883,0.99619699,0.99633269,0.99646592,0.99659670,0.99672502,0.99685087,0.99697427,0.99709520,0.99721366,0.99732967,0.99744321,0.99755429,0.99766290,0.99776905,0.99787274,0.99797396,0.99807271,0.99816900,0.99826283,0.99835419,0.99844309,0.99852951,0.99861348,0.99869497,0.99877400,0.99885057,0.99892466,0.99899629,0.99906545,0.99913215,0.99919637,0.99925813,0.99931742,0.99937424,0.99942860,0.99948048,0.99952990,0.99957685,0.99962133,0.99966334,0.99970288,0.99973995,0.99977456,0.99980669,0.99983636,0.99986355,0.99988828,0.99991053,0.99993032,0.99994764,0.99996248,0.99997486,0.99998477,0.99999221,0.99999718,0.99999968,0.99999971,0.99999726,0.99999235,0.99998497,0.99997512,0.99996280,0.99994801,0.99993075,0.99991103,0.99988883,0.99986416,0.99983702,0.99980741,0.99977534,0.99974079,0.99970378,0.99966429,0.99962234,0.99957792,0.99953103,0.99948167,0.99942984,0.99937554,0.99931878,0.99925955,0.99919785,0.99913368,0.99906704,0.99899794,0.99892637,0.99885233,0.99877583,0.99869685,0.99861542,0.99853151,0.99844514,0.99835630,0.99826500,0.99817123,0.99807500,0.99797630,0.99787514,0.99777151,0.99766542,0.99755686,0.99744584,0.99733236,0.99721641,0.99709800,0.99697713,0.99685379,0.99672800,0.99659974,0.99646902,0.99633584,0.99620020,0.99606209,0.99592153,0.99577851,0.99563303,0.99548509,0.99533469,0.99518183,0.99502652,0.99486874,0.99470851,0.99454583,0.99438068,0.99421308,0.99404303,0.99387052,0.99369556,0.99351814,0.99333826,0.99315594,0.99297116,0.99278393,0.99259425,0.99240211,0.99220753,0.99201049,0.99181100,0.99160907,0.99140468,0.99119785,0.99098857,0.99077684,0.99056266,0.99034604,0.99012697,0.98990546,0.98968150,0.98945510,0.98922625,0.98899496,0.98876123,0.98852505,0.98828643,0.98804538,0.98780188,0.98755594,0.98730757,0.98705675,0.98680350,0.98654781,0.98628968,0.98602912,0.98576612,0.98550069,0.98523282,0.98496252,0.98468979,0.98441463,0.98413703,0.98385701,0.98357455,0.98328966,0.98300235,0.98271261,0.98242044,0.98212584,0.98182882,0.98152938,0.98122751,0.98092321,0.98061650,0.98030736,0.97999580,0.97968182,0.97936542,0.97904660,0.97872536,0.97840171,0.97807564,0.97774716,0.97741625,0.97708294,0.97674721,0.97640907,0.97606852,0.97572556,0.97538019,0.97503240,0.97468221,0.97432962,0.97397461,0.97361721,0.97325739,0.97289518,0.97253056,0.97216353,0.97179411,0.97142229,0.97104806,0.97067144,0.97029243,0.96991101,0.96952720,0.96914100,0.96875240,0.96836141,0.96796803,0.96757225,0.96717409,0.96677354,0.96637060,0.96596527,0.96555756,0.96514746,0.96473498,0.96432012,0.96390288,0.96348325,0.96306124,0.96263686,0.96221010,0.96178096,0.96134945,0.96091556,0.96047930,0.96004067,0.95959966,0.95915629,0.95871055,0.95826244,0.95781196,0.95735912,0.95690391,0.95644634,0.95598640,0.95552411,0.95505945,0.95459244,0.95412307,0.95365134,0.95317726,0.95270082,0.95222203,0.95174089,0.95125740,0.95077156,0.95028337,0.94979283,0.94929995,0.94880472,0.94830715,0.94780724,0.94730498,0.94680039,0.94629346,0.94578419,0.94527258,0.94475865,0.94424237,0.94372377,0.94320283,0.94267957,0.94215397,0.94162605,0.94109581,0.94056324,0.94002834,0.93949113,0.93895159,0.93840974,0.93786556,0.93731908,0.93677027,0.93621915,0.93566572,0.93510998,0.93455193,0.93399158,0.93342891,0.93286394,0.93229667,0.93172709,0.93115521,0.93058103,0.93000456,0.92942578,0.92884471,0.92826135,0.92767570,0.92708775,0.92649751,0.92590499,0.92531018,0.92471308,0.92411370,0.92351204,0.92290809,0.92230187,0.92169337,0.92108259,0.92046954,0.91985421,0.91923661,0.91861674,0.91799461,0.91737020,0.91674353,0.91611460,0.91548340,0.91484994,0.91421423,0.91357625,0.91293602,0.91229353,0.91164879,0.91100180,0.91035256,0.90970107,0.90904733,0.90839135,0.90773313,0.90707266,0.90640995,0.90574501,0.90507782,0.90440840,0.90373675,0.90306287,0.90238675,0.90170841,0.90102784,0.90034504,0.89966002,0.89897278,0.89828332,0.89759164,0.89689774,0.89620163,0.89550330,0.89480277,0.89410002,0.89339506,0.89268790,0.89197853,0.89126696,0.89055319,0.88983722,0.88911905,0.88839869,0.88767613,0.88695138,0.88622444,0.88549530,0.88476399,0.88403048,0.88329480,0.88255693,0.88181688,0.88107466,0.88033026,0.87958368,0.87883493,0.87808401,0.87733093,0.87657567,0.87581825,0.87505867,0.87429693,0.87353302,0.87276696,0.87199875,0.87122838,0.87045586,0.86968118,0.86890436,0.86812540,0.86734429,0.86656104,0.86577565,0.86498812,0.86419845,0.86340665,0.86261272,0.86181665,0.86101846,0.86021814,0.85941570,0.85861113,0.85780444,0.85699564,0.85618472,0.85537168,0.85455653,0.85373927,0.85291990,0.85209843,0.85127485,0.85044917,0.84962138,0.84879150,0.84795953,0.84712546,0.84628929,0.84545104,0.84461070,0.84376827,0.84292376,0.84207716,0.84122849,0.84037774,0.83952491,0.83867001,0.83781304,0.83695400,0.83609289,0.83522972,0.83436448,0.83349718,0.83262783,0.83175642,0.83088295,0.83000743,0.82912987,0.82825025,0.82736859,0.82648488,0.82559914,0.82471135,0.82382153,0.82292967,0.82203579,0.82113987,0.82024192,0.81934195,0.81843995,0.81753593,0.81662989,0.81572184,0.81481177,0.81389969,0.81298560,0.81206950,0.81115139,0.81023128,0.80930917,0.80838506,0.80745896,0.80653086,0.80560077,0.80466869,0.80373462,0.80279856,0.80186053,0.80092051,0.79997852,0.79903454,0.79808860,0.79714069,0.79619080,0.79523895,0.79428514,0.79332936,0.79237162,0.79141193,0.79045028,0.78948668,0.78852113,0.78755364,0.78658420,0.78561281,0.78463949,0.78366422,0.78268702,0.78170789,0.78072683,0.77974384,0.77875892,0.77777208,0.77678332,0.77579264,0.77480005,0.77380554,0.77280912,0.77181079,0.77081055,0.76980842,0.76880438,0.76779844,0.76679060,0.76578087,0.76476925,0.76375574,0.76274035,0.76172307,0.76070391,0.75968287,0.75865995,0.75763516,0.75660850,0.75557997,0.75454958,0.75351732,0.75248320,0.75144722,0.75040938,0.74936970,0.74832816,0.74728477,0.74623954,0.74519246,0.74414355,0.74309279,0.74204020,0.74098578,0.73992953,0.73887145,0.73781154,0.73674982,0.73568627,0.73462091,0.73355373,0.73248474,0.73141394,0.73034134,0.72926693,0.72819072,0.72711271,0.72603290,0.72495131,0.72386792,0.72278274,0.72169578,0.72060704,0.71951651,0.71842421,0.71733014,0.71623429,0.71513668,0.71403730,0.71293615,0.71183325,0.71072858,0.70962216,0.70851399,0.70740407,0.70629240,0.70517899,0.70406383,0.70294694,0.70182831,0.70070794,0.69958585,0.69846203,0.69733648,0.69620921,0.69508022,0.69394952,0.69281710,0.69168297,0.69054713,0.68940958,0.68827033,0.68712939,0.68598674,0.68484241,0.68369638,0.68254866,0.68139925,0.68024817,0.67909540,0.67794095,0.67678483,0.67562704,0.67446758,0.67330646,0.67214367,0.67097922,0.66981312,0.66864536,0.66747595,0.66630489,0.66513218,0.66395784,0.66278185,0.66160422,0.66042497,0.65924408,0.65806156,0.65687741,0.65569165,0.65450426,0.65331526,0.65212465,0.65093242,0.64973859,0.64854315,0.64734611,0.64614747,0.64494724,0.64374541,0.64254199,0.64133699,0.64013040,0.63892223,0.63771248,0.63650116,0.63528827,0.63407380,0.63285777,0.63164018,0.63042103,0.62920032,0.62797805,0.62675424,0.62552888,0.62430197,0.62307352,0.62184353,0.62061201,0.61937895,0.61814436,0.61690825,0.61567061,0.61443146,0.61319078,0.61194859,0.61070489,0.60945968,0.60821297,0.60696475,0.60571503,0.60446382,0.60321112,0.60195692,0.60070124,0.59944408,0.59818543,0.59692531,0.59566371,0.59440064,0.59313610,0.59187010,0.59060264,0.58933372,0.58806334,0.58679151,0.58551823,0.58424351,0.58296734,0.58168973,0.58041069,0.57913021,0.57784830,0.57656496,0.57528020,0.57399402,0.57270643,0.57141741,0.57012699,0.56883516,0.56754192,0.56624728,0.56495124,0.56365381,0.56235499,0.56105477,0.55975317,0.55845019,0.55714583,0.55584009,0.55453299,0.55322451,0.55191466,0.55060345,0.54929088,0.54797696,0.54666168,0.54534505,0.54402707,0.54270775,0.54138709,0.54006510,0.53874177,0.53741710,0.53609112,0.53476380,0.53343517,0.53210522,0.53077395,0.52944138,0.52810749,0.52677230,0.52543581,0.52409803,0.52275895,0.52141857,0.52007691,0.51873397,0.51738974,0.51604424,0.51469746,0.51334941,0.51200009,0.51064951,0.50929767,0.50794457,0.50659021,0.50523461,0.50387775,0.50251965,0.50116031,0.49979973,0.49843792,0.49707488,0.49571061,0.49434511,0.49297839,0.49161046,0.49024131,0.48887095,0.48749939,0.48612662,0.48475265,0.48337748,0.48200112,0.48062356,0.47924482,0.47786490,0.47648380,0.47510152,0.47371806,0.47233344,0.47094765,0.46956069,0.46817258,0.46678331,0.46539289,0.46400132,0.46260860,0.46121474,0.45981974,0.45842361,0.45702634,0.45562794,0.45422842,0.45282778,0.45142602,0.45002314,0.44861915,0.44721405,0.44580785,0.44440055,0.44299215,0.44158266,0.44017208,0.43876040,0.43734765,0.43593382,0.43451890,0.43310292,0.43168586,0.43026774,0.42884856,0.42742832,0.42600702,0.42458467,0.42316127,0.42173683,0.42031134,0.41888482,0.41745726,0.41602867,0.41459905,0.41316841,0.41173675,0.41030407,0.40887038,0.40743568,0.40599997,0.40456326,0.40312555,0.40168684,0.40024715,0.39880646,0.39736479,0.39592214,0.39447851,0.39303390,0.39158833,0.39014178,0.38869428,0.38724581,0.38579639,0.38434601,0.38289469,0.38144242,0.37998921,0.37853506,0.37707997,0.37562395,0.37416701,0.37270914,0.37125035,0.36979064,0.36833003,0.36686850,0.36540606,0.36394272,0.36247849,0.36101335,0.35954733,0.35808042,0.35661262,0.35514395,0.35367439,0.35220396,0.35073267,0.34926050,0.34778748,0.34631359,0.34483885,0.34336326,0.34188682,0.34040953,0.33893141,0.33745245,0.33597265,0.33449202,0.33301057,0.33152830,0.33004521,0.32856130,0.32707658,0.32559105,0.32410472,0.32261759,0.32112966,0.31964093,0.31815142,0.31666113,0.31517005,0.31367819,0.31218556,0.31069215,0.30919798,0.30770305,0.30620735,0.30471090,0.30321370,0.30171575,0.30021705,0.29871761,0.29721743,0.29571652,0.29421488,0.29271251,0.29120942,0.28970561,0.28820109,0.28669585,0.28518990,0.28368325,0.28217590,0.28066785,0.27915911,0.27764968,0.27613957,0.27462877,0.27311729,0.27160514,0.27009232,0.26857883,0.26706468,0.26554987,0.26403440,0.26251828,0.26100152,0.25948410,0.25796605,0.25644736,0.25492804,0.25340808,0.25188750,0.25036630,0.24884448,0.24732205,0.24579900,0.24427535,0.24275109,0.24122624,0.23970079,0.23817474,0.23664811,0.23512090,0.23359310,0.23206473,0.23053578,0.22900627,0.22747618,0.22594554,0.22441434,0.22288258,0.22135028,0.21981743,0.21828403,0.21675009,0.21521562,0.21368062,0.21214509,0.21060904,0.20907247,0.20753538,0.20599777,0.20445966,0.20292105,0.20138193,0.19984231,0.19830221,0.19676161,0.19522052,0.19367896,0.19213691,0.19059439,0.18905140,0.18750795,0.18596403,0.18441965,0.18287481,0.18132953,0.17978379,0.17823761,0.17669100,0.17514394,0.17359645,0.17204854,0.17050020,0.16895143,0.16740225,0.16585266,0.16430266,0.16275225,0.16120144,0.15965023,0.15809863,0.15654664,0.15499426,0.15344149,0.15188835,0.15033483,0.14878095,0.14722669,0.14567207,0.14411709,0.14256176,0.14100607,0.13945004,0.13789366,0.13633694,0.13477988,0.13322249,0.13166477,0.13010673,0.12854836,0.12698968,0.12543068,0.12387137,0.12231176,0.12075185,0.11919164,0.11763113,0.11607033,0.11450925,0.11294788,0.11138623,0.10982431,0.10826212,0.10669966,0.10513694,0.10357395,0.10201072,0.10044723,0.09888349,0.09731950,0.09575528,0.09419082,0.09262613,0.09106121,0.08949606,0.08793069,0.08636511,0.08479931,0.08323330,0.08166709,0.08010068,0.07853407,0.07696726,0.07540026,0.07383308,0.07226572,0.07069817,0.06913045,0.06756257,0.06599451,0.06442629,0.06285791,0.06128938,0.05972070,0.05815187,0.05658289,0.05501377,0.05344452,0.05187514,0.05030563,0.04873599,0.04716624,0.04559637,0.04402638,0.04245629,0.04088609,0.03931579,0.03774539,0.03617490,0.03460432,0.03303366,0.03146291,0.02989209,0.02832119,0.02675022,0.02517919,0.02360810,0.02203694,0.02046573,0.01889447,0.01732317,0.01575182,0.01418043,0.01260901,0.01103756,0.00946607,0.00789457,0.00632305,0.00475151,0.00317996,0.00160840,0.00003683,-0.00153473,-0.00310629,-0.00467784,-0.00624938,-0.00782091,-0.00939241,-0.01096389,-0.01253535,-0.01410677,-0.01567816,-0.01724951,-0.01882082,-0.02039208,-0.02196329,-0.02353445,-0.02510555,-0.02667658,-0.02824756,-0.02981846,-0.03138928,-0.03296003,-0.03453070,-0.03610128,-0.03767178,-0.03924218,-0.04081248,-0.04238269,-0.04395279,-0.04552278,-0.04709265,-0.04866241,-0.05023206,-0.05180157,-0.05337096,-0.05494022,-0.05650934,-0.05807832,-0.05964716,-0.06121585,-0.06278439,-0.06435278,-0.06592100,-0.06748907,-0.06905696,-0.07062469,-0.07219224,-0.07375961,-0.07532681};
ap_fixed<10,2> cos_lut[2048] = {1.00000000,0.99999877,0.99999506,0.99998889,0.99998024,0.99996913,0.99995554,0.99993949,0.99992097,0.99989997,0.99987651,0.99985058,0.99982218,0.99979131,0.99975797,0.99972216,0.99968388,0.99964313,0.99959992,0.99955423,0.99950608,0.99945546,0.99940236,0.99934681,0.99928878,0.99922828,0.99916532,0.99909989,0.99903199,0.99896162,0.99888879,0.99881349,0.99873572,0.99865549,0.99857279,0.99848762,0.99839999,0.99830989,0.99821733,0.99812230,0.99802480,0.99792484,0.99782242,0.99771753,0.99761017,0.99750036,0.99738808,0.99727333,0.99715613,0.99703646,0.99691432,0.99678973,0.99666267,0.99653315,0.99640117,0.99626673,0.99612983,0.99599047,0.99584865,0.99570437,0.99555763,0.99540843,0.99525677,0.99510266,0.99494609,0.99478706,0.99462557,0.99446163,0.99429523,0.99412637,0.99395506,0.99378129,0.99360507,0.99342640,0.99324527,0.99306169,0.99287566,0.99268717,0.99249623,0.99230284,0.99210701,0.99190872,0.99170798,0.99150479,0.99129915,0.99109106,0.99088053,0.99066755,0.99045212,0.99023424,0.99001392,0.98979116,0.98956595,0.98933830,0.98910820,0.98887566,0.98864068,0.98840325,0.98816339,0.98792108,0.98767633,0.98742915,0.98717952,0.98692746,0.98667296,0.98641602,0.98615665,0.98589484,0.98563060,0.98536392,0.98509481,0.98482327,0.98454929,0.98427288,0.98399404,0.98371277,0.98342907,0.98314294,0.98285439,0.98256340,0.98226999,0.98197416,0.98167589,0.98137521,0.98107210,0.98076656,0.98045861,0.98014823,0.97983543,0.97952021,0.97920258,0.97888252,0.97856005,0.97823516,0.97790785,0.97757813,0.97724599,0.97691144,0.97657448,0.97623511,0.97589332,0.97554913,0.97520252,0.97485351,0.97450208,0.97414826,0.97379202,0.97343338,0.97307234,0.97270889,0.97234304,0.97197479,0.97160414,0.97123109,0.97085564,0.97047779,0.97009755,0.96971491,0.96932987,0.96894244,0.96855262,0.96816041,0.96776580,0.96736880,0.96696942,0.96656764,0.96616348,0.96575694,0.96534800,0.96493669,0.96452299,0.96410691,0.96368844,0.96326760,0.96284438,0.96241878,0.96199080,0.96156045,0.96112772,0.96069262,0.96025514,0.95981529,0.95937308,0.95892849,0.95848154,0.95803221,0.95758053,0.95712647,0.95667006,0.95621128,0.95575013,0.95528663,0.95482077,0.95435255,0.95388197,0.95340904,0.95293375,0.95245611,0.95197612,0.95149377,0.95100908,0.95052204,0.95003264,0.94954091,0.94904682,0.94855040,0.94805163,0.94755052,0.94704707,0.94654128,0.94603315,0.94552268,0.94500988,0.94449475,0.94397728,0.94345749,0.94293536,0.94241090,0.94188412,0.94135501,0.94082357,0.94028981,0.93975373,0.93921533,0.93867460,0.93813156,0.93758620,0.93703853,0.93648854,0.93593624,0.93538163,0.93482471,0.93426548,0.93370394,0.93314009,0.93257394,0.93200549,0.93143473,0.93086168,0.93028633,0.92970867,0.92912873,0.92854648,0.92796195,0.92737512,0.92678600,0.92619459,0.92560090,0.92500492,0.92440665,0.92380610,0.92320327,0.92259816,0.92199077,0.92138110,0.92076916,0.92015495,0.91953846,0.91891970,0.91829867,0.91767537,0.91704981,0.91642198,0.91579189,0.91515953,0.91452492,0.91388804,0.91324891,0.91260753,0.91196389,0.91131800,0.91066985,0.91001946,0.90936682,0.90871194,0.90805481,0.90739543,0.90673382,0.90606997,0.90540387,0.90473555,0.90406499,0.90339219,0.90271717,0.90203991,0.90136043,0.90067872,0.89999478,0.89930863,0.89862025,0.89792965,0.89723684,0.89654181,0.89584456,0.89514510,0.89444343,0.89373956,0.89303347,0.89232518,0.89161468,0.89090199,0.89018709,0.88946999,0.88875070,0.88802921,0.88730553,0.88657966,0.88585160,0.88512135,0.88438891,0.88365429,0.88291749,0.88217851,0.88143734,0.88069400,0.87994849,0.87920080,0.87845094,0.87769891,0.87694472,0.87618836,0.87542983,0.87466914,0.87390629,0.87314128,0.87237412,0.87160480,0.87083333,0.87005971,0.86928394,0.86850602,0.86772596,0.86694375,0.86615941,0.86537292,0.86458430,0.86379354,0.86300064,0.86220562,0.86140847,0.86060919,0.85980778,0.85900425,0.85819860,0.85739083,0.85658094,0.85576893,0.85495482,0.85413859,0.85332025,0.85249980,0.85167725,0.85085259,0.85002584,0.84919698,0.84836603,0.84753298,0.84669784,0.84586060,0.84502128,0.84417987,0.84333638,0.84249080,0.84164314,0.84079340,0.83994159,0.83908770,0.83823174,0.83737371,0.83651361,0.83565145,0.83478722,0.83392093,0.83305258,0.83218217,0.83130971,0.83043519,0.82955862,0.82868001,0.82779934,0.82691664,0.82603189,0.82514510,0.82425627,0.82336541,0.82247251,0.82157758,0.82068062,0.81978164,0.81888063,0.81797760,0.81707255,0.81616548,0.81525639,0.81434529,0.81343218,0.81251706,0.81159993,0.81068080,0.80975967,0.80883654,0.80791141,0.80698428,0.80605516,0.80512405,0.80419095,0.80325587,0.80231880,0.80137975,0.80043872,0.79949571,0.79855073,0.79760378,0.79665486,0.79570397,0.79475111,0.79379629,0.79283951,0.79188078,0.79092008,0.78995744,0.78899284,0.78802629,0.78705780,0.78608736,0.78511498,0.78414067,0.78316441,0.78218622,0.78120610,0.78022406,0.77924008,0.77825418,0.77726635,0.77627661,0.77528495,0.77429138,0.77329589,0.77229849,0.77129919,0.77029798,0.76929487,0.76828985,0.76728294,0.76627414,0.76526344,0.76425086,0.76323638,0.76222002,0.76120178,0.76018166,0.75915966,0.75813578,0.75711003,0.75608242,0.75505293,0.75402158,0.75298837,0.75195330,0.75091637,0.74987759,0.74883695,0.74779447,0.74675014,0.74570396,0.74465594,0.74360608,0.74255439,0.74150086,0.74044550,0.73938832,0.73832930,0.73726847,0.73620581,0.73514133,0.73407504,0.73300693,0.73193702,0.73086529,0.72979177,0.72871644,0.72763930,0.72656038,0.72547965,0.72439714,0.72331284,0.72222675,0.72113887,0.72004922,0.71895779,0.71786458,0.71676960,0.71567284,0.71457432,0.71347404,0.71237199,0.71126819,0.71016263,0.70905531,0.70794624,0.70683542,0.70572286,0.70460856,0.70349251,0.70237473,0.70125521,0.70013396,0.69901098,0.69788628,0.69675985,0.69563170,0.69450183,0.69337025,0.69223695,0.69110195,0.68996524,0.68882682,0.68768670,0.68654489,0.68540138,0.68425617,0.68310928,0.68196070,0.68081043,0.67965848,0.67850486,0.67734955,0.67619258,0.67503394,0.67387362,0.67271165,0.67154801,0.67038271,0.66921576,0.66804716,0.66687690,0.66570500,0.66453145,0.66335627,0.66217944,0.66100098,0.65982089,0.65863916,0.65745581,0.65627084,0.65508424,0.65389603,0.65270620,0.65151476,0.65032172,0.64912706,0.64793080,0.64673294,0.64553349,0.64433244,0.64312980,0.64192557,0.64071975,0.63951235,0.63830338,0.63709282,0.63588070,0.63466700,0.63345173,0.63223490,0.63101651,0.62979656,0.62857506,0.62735200,0.62612739,0.62490124,0.62367354,0.62244430,0.62121353,0.61998122,0.61874738,0.61751201,0.61627512,0.61503670,0.61379677,0.61255532,0.61131235,0.61006788,0.60882190,0.60757442,0.60632543,0.60507495,0.60382297,0.60256951,0.60131455,0.60005811,0.59880019,0.59754079,0.59627991,0.59501756,0.59375374,0.59248845,0.59122170,0.58995349,0.58868382,0.58741270,0.58614013,0.58486611,0.58359065,0.58231374,0.58103540,0.57975562,0.57847441,0.57719177,0.57590771,0.57462222,0.57333531,0.57204699,0.57075726,0.56946611,0.56817356,0.56687960,0.56558425,0.56428750,0.56298935,0.56168982,0.56038889,0.55908659,0.55778290,0.55647783,0.55517139,0.55386358,0.55255440,0.55124386,0.54993195,0.54861869,0.54730407,0.54598810,0.54467078,0.54335212,0.54203211,0.54071077,0.53938809,0.53806408,0.53673874,0.53541207,0.53408408,0.53275477,0.53142415,0.53009221,0.52875897,0.52742441,0.52608856,0.52475141,0.52341296,0.52207321,0.52073218,0.51938986,0.51804626,0.51670138,0.51535523,0.51400780,0.51265910,0.51130913,0.50995791,0.50860542,0.50725167,0.50589668,0.50454043,0.50318294,0.50182421,0.50046423,0.49910302,0.49774058,0.49637691,0.49501201,0.49364589,0.49227855,0.49090999,0.48954023,0.48816925,0.48679707,0.48542368,0.48404910,0.48267332,0.48129634,0.47991818,0.47853884,0.47715831,0.47577660,0.47439372,0.47300967,0.47162445,0.47023806,0.46885052,0.46746181,0.46607195,0.46468094,0.46328878,0.46189548,0.46050103,0.45910545,0.45770874,0.45631089,0.45491192,0.45351183,0.45211061,0.45070828,0.44930483,0.44790028,0.44649461,0.44508785,0.44367999,0.44227103,0.44086097,0.43944983,0.43803761,0.43662430,0.43520991,0.43379445,0.43237792,0.43096032,0.42954165,0.42812193,0.42670114,0.42527931,0.42385642,0.42243249,0.42100751,0.41958149,0.41815444,0.41672635,0.41529723,0.41386709,0.41243593,0.41100375,0.40957055,0.40813634,0.40670112,0.40526490,0.40382768,0.40238946,0.40095025,0.39951004,0.39806885,0.39662668,0.39518353,0.39373940,0.39229430,0.39084822,0.38940119,0.38795319,0.38650424,0.38505432,0.38360346,0.38215165,0.38069890,0.37924521,0.37779058,0.37633502,0.37487852,0.37342111,0.37196277,0.37050351,0.36904333,0.36758225,0.36612025,0.36465736,0.36319356,0.36172886,0.36026327,0.35879679,0.35732943,0.35586118,0.35439206,0.35292206,0.35145118,0.34997944,0.34850684,0.34703337,0.34555905,0.34408387,0.34260784,0.34113097,0.33965325,0.33817470,0.33669531,0.33521509,0.33373404,0.33225217,0.33076947,0.32928596,0.32780164,0.32631651,0.32483057,0.32334382,0.32185628,0.32036795,0.31887882,0.31738891,0.31589821,0.31440673,0.31291448,0.31142145,0.30992765,0.30843309,0.30693777,0.30544168,0.30394485,0.30244726,0.30094893,0.29944985,0.29795003,0.29644948,0.29494819,0.29344618,0.29194344,0.29043998,0.28893581,0.28743092,0.28592532,0.28441901,0.28291200,0.28140429,0.27989589,0.27838680,0.27687701,0.27536655,0.27385540,0.27234358,0.27083109,0.26931792,0.26780410,0.26628961,0.26477446,0.26325866,0.26174221,0.26022511,0.25870737,0.25718899,0.25566997,0.25415033,0.25263005,0.25110915,0.24958763,0.24806550,0.24654275,0.24501940,0.24349543,0.24197087,0.24044571,0.23891996,0.23739361,0.23586668,0.23433917,0.23281108,0.23128241,0.22975317,0.22822336,0.22669300,0.22516207,0.22363058,0.22209854,0.22056596,0.21903283,0.21749915,0.21596494,0.21443020,0.21289493,0.21135913,0.20982281,0.20828597,0.20674862,0.20521076,0.20367239,0.20213351,0.20059414,0.19905427,0.19751391,0.19597307,0.19443174,0.19288992,0.19134764,0.18980488,0.18826165,0.18671795,0.18517380,0.18362918,0.18208412,0.18053860,0.17899264,0.17744624,0.17589939,0.17435212,0.17280441,0.17125627,0.16970772,0.16815874,0.16660935,0.16505955,0.16350934,0.16195872,0.16040771,0.15885630,0.15730449,0.15575230,0.15419973,0.15264677,0.15109343,0.14953973,0.14798565,0.14643121,0.14487640,0.14332124,0.14176573,0.14020986,0.13865365,0.13709710,0.13554020,0.13398297,0.13242542,0.13086753,0.12930932,0.12775079,0.12619195,0.12463279,0.12307333,0.12151356,0.11995350,0.11839313,0.11683248,0.11527153,0.11371030,0.11214879,0.11058700,0.10902494,0.10746261,0.10590002,0.10433716,0.10277405,0.10121068,0.09964706,0.09808320,0.09651909,0.09495475,0.09339017,0.09182536,0.09026032,0.08869506,0.08712958,0.08556389,0.08399798,0.08243187,0.08086555,0.07929904,0.07773233,0.07616542,0.07459833,0.07303105,0.07146360,0.06989596,0.06832816,0.06676018,0.06519204,0.06362374,0.06205529,0.06048667,0.05891791,0.05734901,0.05577996,0.05421078,0.05264146,0.05107201,0.04950243,0.04793274,0.04636292,0.04479299,0.04322295,0.04165280,0.04008255,0.03851220,0.03694176,0.03537122,0.03380060,0.03222989,0.03065910,0.02908824,0.02751731,0.02594631,0.02437524,0.02280411,0.02123293,0.01966170,0.01809041,0.01651908,0.01494772,0.01337631,0.01180487,0.01023340,0.00866191,0.00709039,0.00551886,0.00394732,0.00237576,0.00080420,-0.00076737,-0.00233893,-0.00391048,-0.00548203,-0.00705356,-0.00862508,-0.01019657,-0.01176804,-0.01333948,-0.01491089,-0.01648226,-0.01805358,-0.01962487,-0.02119611,-0.02276729,-0.02433842,-0.02590948,-0.02748049,-0.02905142,-0.03062229,-0.03219308,-0.03376378,-0.03533441,-0.03690495,-0.03847539,-0.04004575,-0.04161600,-0.04318615,-0.04475619,-0.04632613,-0.04789594,-0.04946564,-0.05103522,-0.05260467,-0.05417400,-0.05574319,-0.05731224,-0.05888115,-0.06044991,-0.06201852,-0.06358698,-0.06515529,-0.06672343,-0.06829141,-0.06985922,-0.07142686,-0.07299432,-0.07456160,-0.07612869,-0.07769560,-0.07926232,-0.08082884,-0.08239516,-0.08396128,-0.08552719,-0.08709289,-0.08865837,-0.09022364,-0.09178868,-0.09335349,-0.09491808,-0.09648243,-0.09804654,-0.09961041,-0.10117404,-0.10273741,-0.10430053,-0.10586339,-0.10742599,-0.10898833,-0.11055040,-0.11211219,-0.11367371,-0.11523494,-0.11679589,-0.11835656,-0.11991693,-0.12147700,-0.12303678,-0.12459625,-0.12615541,-0.12771426,-0.12927280,-0.13083101,-0.13238891,-0.13394647,-0.13550371,-0.13706061,-0.13861717,-0.14017339,-0.14172927,-0.14328479,-0.14483996,-0.14639477,-0.14794922,-0.14950331,-0.15105702,-0.15261037,-0.15416333,-0.15571592,-0.15726812,-0.15881993,-0.16037135,-0.16192237,-0.16347300,-0.16502322,-0.16657303,-0.16812243,-0.16967142,-0.17121999,-0.17276813,-0.17431585,-0.17586313,-0.17740999,-0.17895640,-0.18050237,-0.18204790,-0.18359298,-0.18513760,-0.18668177,-0.18822547,-0.18976871,-0.19131148,-0.19285378,-0.19439560,-0.19593695,-0.19747781,-0.19901818,-0.20055806,-0.20209744,-0.20363633,-0.20517471,-0.20671258,-0.20824995,-0.20978680,-0.21132313,-0.21285894,-0.21439422,-0.21592898,-0.21746320,-0.21899689,-0.22053003,-0.22206263,-0.22359468,-0.22512618,-0.22665712,-0.22818750,-0.22971732,-0.23124657,-0.23277525,-0.23430336,-0.23583089,-0.23735783,-0.23888419,-0.24040996,-0.24193513,-0.24345971,-0.24498369,-0.24650706,-0.24802982,-0.24955197,-0.25107350,-0.25259441,-0.25411470,-0.25563436,-0.25715339,-0.25867179,-0.26018954,-0.26170666,-0.26322312,-0.26473894,-0.26625410,-0.26776861,-0.26928245,-0.27079563,-0.27230814,-0.27381998,-0.27533114,-0.27684162,-0.27835142,-0.27986053,-0.28136895,-0.28287667,-0.28438370,-0.28589002,-0.28739564,-0.28890054,-0.29040474,-0.29190821,-0.29341097,-0.29491300,-0.29641430,-0.29791487,-0.29941471,-0.30091380,-0.30241215,-0.30390976,-0.30540661,-0.30690271,-0.30839805,-0.30989263,-0.31138645,-0.31287949,-0.31437177,-0.31586326,-0.31735398,-0.31884391,-0.32033306,-0.32182141,-0.32330897,-0.32479573,-0.32628169,-0.32776684,-0.32925118,-0.33073471,-0.33221743,-0.33369932,-0.33518039,-0.33666063,-0.33814004,-0.33961861,-0.34109635,-0.34257324,-0.34404928,-0.34552448,-0.34699882,-0.34847231,-0.34994494,-0.35141670,-0.35288759,-0.35435761,-0.35582676,-0.35729503,-0.35876241,-0.36022891,-0.36169452,-0.36315924,-0.36462306,-0.36608598,-0.36754799,-0.36900910,-0.37046929,-0.37192857,-0.37338694,-0.37484438,-0.37630089,-0.37775647,-0.37921113,-0.38066484,-0.38211762,-0.38356945,-0.38502033,-0.38647026,-0.38791924,-0.38936726,-0.39081432,-0.39226041,-0.39370554,-0.39514969,-0.39659287,-0.39803506,-0.39947628,-0.40091650,-0.40235574,-0.40379398,-0.40523123,-0.40666747,-0.40810271,-0.40953695,-0.41097017,-0.41240237,-0.41383356,-0.41526373,-0.41669287,-0.41812098,-0.41954806,-0.42097410,-0.42239910,-0.42382306,-0.42524597,-0.42666783,-0.42808864,-0.42950839,-0.43092708,-0.43234471,-0.43376126,-0.43517675,-0.43659116,-0.43800449,-0.43941675,-0.44082791,-0.44223799,-0.44364698,-0.44505486,-0.44646166,-0.44786734,-0.44927192,-0.45067540,-0.45207775,-0.45347900,-0.45487912,-0.45627812,-0.45767599,-0.45907273,-0.46046834,-0.46186281,-0.46325614,-0.46464832,-0.46603936,-0.46742925,-0.46881798,-0.47020556,-0.47159197,-0.47297722,-0.47436130,-0.47574421,-0.47712594,-0.47850650,-0.47988587,-0.48126406,-0.48264106,-0.48401686,-0.48539148,-0.48676489,-0.48813710,-0.48950811,-0.49087790,-0.49224649,-0.49361386,-0.49498000,-0.49634493,-0.49770863,-0.49907110,-0.50043234,-0.50179235,-0.50315111,-0.50450863,-0.50586491,-0.50721993,-0.50857370,-0.50992622,-0.51127748,-0.51262747,-0.51397620,-0.51532366,-0.51666985,-0.51801476,-0.51935839,-0.52070074,-0.52204180,-0.52338157,-0.52472005,-0.52605723,-0.52739312,-0.52872770,-0.53006098,-0.53139295,-0.53272360,-0.53405294,-0.53538096,-0.53670766,-0.53803303,-0.53935707,-0.54067978,-0.54200116,-0.54332120,-0.54463989,-0.54595724,-0.54727325,-0.54858790,-0.54990119,-0.55121313,-0.55252370,-0.55383291,-0.55514076,-0.55644723,-0.55775233,-0.55905605,-0.56035839,-0.56165934,-0.56295891,-0.56425709,-0.56555387,-0.56684926,-0.56814325,-0.56943583,-0.57072701,-0.57201678,-0.57330513,-0.57459207,-0.57587759,-0.57716169,-0.57844436,-0.57972561,-0.58100542,-0.58228380,-0.58356074,-0.58483623,-0.58611029,-0.58738289,-0.58865405,-0.58992375,-0.59119199,-0.59245878,-0.59372410,-0.59498795,-0.59625034,-0.59751125,-0.59877069,-0.60002864,-0.60128512,-0.60254011,-0.60379361,-0.60504562,-0.60629614,-0.60754516,-0.60879268,-0.61003870,-0.61128320,-0.61252620,-0.61376769,-0.61500766,-0.61624611,-0.61748304,-0.61871844,-0.61995232,-0.62118466,-0.62241547,-0.62364475,-0.62487248,-0.62609867,-0.62732331,-0.62854641,-0.62976795,-0.63098794,-0.63220636,-0.63342323,-0.63463853,-0.63585227,-0.63706443,-0.63827502,-0.63948404,-0.64069147,-0.64189732,-0.64310159,-0.64430427,-0.64550536,-0.64670485,-0.64790275,-0.64909904,-0.65029373,-0.65148682,-0.65267830,-0.65386816,-0.65505641,-0.65624305,-0.65742806,-0.65861145,-0.65979321,-0.66097334,-0.66215184,-0.66332870,-0.66450393,-0.66567751,-0.66684945,-0.66801975,-0.66918839,-0.67035538,-0.67152072,-0.67268439,-0.67384641,-0.67500676,-0.67616544,-0.67732246,-0.67847780,-0.67963146,-0.68078345,-0.68193376,-0.68308238,-0.68422931,-0.68537455,-0.68651811,-0.68765996,-0.68880012,-0.68993857,-0.69107533,-0.69221037,-0.69334371,-0.69447533,-0.69560524,-0.69673343,-0.69785990,-0.69898464,-0.70010766,-0.70122895,-0.70234851,-0.70346633,-0.70458242,-0.70569677,-0.70680937,-0.70792023,-0.70902933,-0.71013669,-0.71124230,-0.71234614,-0.71344823,-0.71454856,-0.71564712,-0.71674391,-0.71783893,-0.71893218,-0.72002366,-0.72111336,-0.72220127,-0.72328740,-0.72437175,-0.72545430,-0.72653507,-0.72761404,-0.72869121,-0.72976658,-0.73084015,-0.73191192,-0.73298188,-0.73405003,-0.73511636,-0.73618088,-0.73724358,-0.73830446,-0.73936352,-0.74042075,-0.74147615,-0.74252972,-0.74358146,-0.74463136,-0.74567942,-0.74672564,-0.74777001,-0.74881254,-0.74985322,-0.75089205,-0.75192902,-0.75296413,-0.75399739,-0.75502878,-0.75605831,-0.75708597,-0.75811176,-0.75913568,-0.76015772,-0.76117789,-0.76219618,-0.76321258,-0.76422710,-0.76523973,-0.76625047,-0.76725932,-0.76826628,-0.76927133,-0.77027449,-0.77127574,-0.77227509,-0.77327254,-0.77426807,-0.77526169,-0.77625339,-0.77724318,-0.77823105,-0.77921699,-0.78020102,-0.78118311,-0.78216328,-0.78314151,-0.78411781,-0.78509217,-0.78606459,-0.78703508,-0.78800361,-0.78897021,-0.78993485,-0.79089754,-0.79185828,-0.79281706,-0.79377389,-0.79472876,-0.79568166,-0.79663259,-0.79758156,-0.79852856,-0.79947359,-0.80041664,-0.80135772,-0.80229681,-0.80323393,-0.80416906,-0.80510221,-0.80603336,-0.80696253,-0.80788970,-0.80881488,-0.80973806,-0.81065924,-0.81157842,-0.81249559,-0.81341076,-0.81432391,-0.81523506,-0.81614419,-0.81705131,-0.81795641,-0.81885949,-0.81976054,-0.82065958,-0.82155658,-0.82245156,-0.82334450,-0.82423541,-0.82512429,-0.82601113,-0.82689592,-0.82777868,-0.82865939,-0.82953805,-0.83041467,-0.83128923,-0.83216174,-0.83303220,-0.83390060,-0.83476694,-0.83563121,-0.83649343,-0.83735358,-0.83821165,-0.83906766,-0.83992160,-0.84077346,-0.84162325,-0.84247096,-0.84331658,-0.84416012,-0.84500158,-0.84584095,-0.84667824,-0.84751343,-0.84834653,-0.84917753,-0.85000644,-0.85083324,-0.85165795,-0.85248055,-0.85330104,-0.85411943,-0.85493571,-0.85574988,-0.85656193,-0.85737187,-0.85817969,-0.85898539,-0.85978897,-0.86059043,-0.86138976,-0.86218696,-0.86298204,-0.86377498,-0.86456579,-0.86535446,-0.86614100,-0.86692539,-0.86770765,-0.86848776,-0.86926573,-0.87004155,-0.87081522,-0.87158675,-0.87235611,-0.87312333,-0.87388839,-0.87465129,-0.87541203,-0.87617060,-0.87692702,-0.87768126,-0.87843334,-0.87918325,-0.87993099,-0.88067656,-0.88141995,-0.88216116,-0.88290019,-0.88363705,-0.88437172,-0.88510421,-0.88583451,-0.88656262,-0.88728855,-0.88801228,-0.88873382,-0.88945316,-0.89017031,-0.89088526,-0.89159801,-0.89230855,-0.89301689,-0.89372303,-0.89442696,-0.89512868,-0.89582819,-0.89652549,-0.89722057,-0.89791344,-0.89860409,-0.89929252,-0.89997873,-0.90066271,-0.90134447,-0.90202401,-0.90270132,-0.90337640,-0.90404924,-0.90471986,-0.90538824,-0.90605438,-0.90671829,-0.90737995,-0.90803938,-0.90869656,-0.90935150,-0.91000419,-0.91065464,-0.91130283,-0.91194878,-0.91259247,-0.91323391,-0.91387309,-0.91451002,-0.91514468,-0.91577709,-0.91640724,-0.91703512,-0.91766073,-0.91828409,-0.91890517,-0.91952398,-0.92014052,-0.92075479,-0.92136679,-0.92197651,-0.92258395,-0.92318911,-0.92379200,-0.92439260,-0.92499092,-0.92558695,-0.92618070,-0.92677216,-0.92736134,-0.92794822,-0.92853281,-0.92911511,-0.92969511,-0.93027281,-0.93084822,-0.93142133,-0.93199214,-0.93256065,-0.93312685,-0.93369075,-0.93425234,-0.93481163,-0.93536860,-0.93592327,-0.93647563,-0.93702567,-0.93757339,-0.93811881,-0.93866190,-0.93920268,-0.93974114,-0.94027727,-0.94081109,-0.94134258,-0.94187174,-0.94239858,-0.94292309,-0.94344528,-0.94396513,-0.94448265,-0.94499784,-0.94551069,-0.94602121,-0.94652939,-0.94703524,-0.94753874,-0.94803991,-0.94853873,-0.94903522,-0.94952935,-0.95002115,-0.95051059,-0.95099769,-0.95148244,-0.95196484,-0.95244489,-0.95292259,-0.95339793,-0.95387092,-0.95434155,-0.95480982,-0.95527574,-0.95573930,-0.95620049,-0.95665933,-0.95711580,-0.95756991,-0.95802165,-0.95847103,-0.95891804,-0.95936268,-0.95980496,-0.96024486,-0.96068239,-0.96111755,-0.96155033,-0.96198074,-0.96240877,-0.96283443,-0.96325771,-0.96367861,-0.96409713,-0.96451326,-0.96492702,-0.96533839,-0.96574738,-0.96615398,-0.96655820,-0.96696003,-0.96735947,-0.96775652,-0.96815118,-0.96854345,-0.96893333,-0.96932082,-0.96970591,-0.97008861,-0.97046891,-0.97084681,-0.97122232,-0.97159543,-0.97196613,-0.97233444,-0.97270035,-0.97306385,-0.97342495,-0.97378364,-0.97413993,-0.97449382,-0.97484530,-0.97519437,-0.97554103,-0.97588528,-0.97622712,-0.97656655,-0.97690357,-0.97723818,-0.97757037,-0.97790015,-0.97822751,-0.97855246,-0.97887499,-0.97919510,-0.97951280,-0.97982807,-0.98014093,-0.98045136,-0.98075937,-0.98106496,-0.98136813,-0.98166887,-0.98196719,-0.98226309,-0.98255655,-0.98284759,-0.98313621,-0.98342239,-0.98370615,-0.98398748,-0.98426637,-0.98454284,-0.98481687,-0.98508847,-0.98535764,-0.98562438,-0.98588868,-0.98615054,-0.98640997,-0.98666697,-0.98692152,-0.98717364,-0.98742333,-0.98767057,-0.98791537,-0.98815773,-0.98839766,-0.98863514,-0.98887018,-0.98910278,-0.98933293,-0.98956064,-0.98978591,-0.99000873,-0.99022911,-0.99044704,-0.99066253,-0.99087556,-0.99108616,-0.99129430,-0.99149999,-0.99170324,-0.99190404,-0.99210239,-0.99229828,-0.99249173,-0.99268272,-0.99287127,-0.99305736,-0.99324100,-0.99342218,-0.99360091,-0.99377719,-0.99395102,-0.99412238,-0.99429130,-0.99445775,-0.99462176,-0.99478330,-0.99494239,-0.99509902,-0.99525319,-0.99540491,-0.99555416,-0.99570096,-0.99584530,-0.99598718,-0.99612659,-0.99626355,-0.99639805,-0.99653009,-0.99665966,-0.99678678,-0.99691143,-0.99703362,-0.99715335,-0.99727061,-0.99738542,-0.99749775,-0.99760763,-0.99771504,-0.99781999,-0.99792247,-0.99802249,-0.99812004,-0.99821513,-0.99830775,-0.99839790,-0.99848560,-0.99857082,-0.99865358,-0.99873387,-0.99881170,-0.99888705,-0.99895994,-0.99903037,-0.99909833,-0.99916381,-0.99922684,-0.99928739,-0.99934547,-0.99940109,-0.99945424,-0.99950492,-0.99955313,-0.99959887,-0.99964215,-0.99968295,-0.99972129,-0.99975716,-0.99979055,-0.99982148,-0.99984994,-0.99987593,-0.99989945,-0.99992050,-0.99993908,-0.99995520,-0.99996884,-0.99998001,-0.99998871,-0.99999494,-0.99999871,-1.00000000,-0.99999882,-0.99999518,-0.99998906,-0.99998047,-0.99996942,-0.99995589,-0.99993989,-0.99992143,-0.99990049,-0.99987709,-0.99985122,-0.99982287,-0.99979206,-0.99975878,-0.99972303,-0.99968481,-0.99964412,-0.99960096,-0.99955533,-0.99950724,-0.99945667,-0.99940364,-0.99934814,-0.99929017,-0.99922973,-0.99916682,-0.99910145,-0.99903361,-0.99896330,-0.99889053,-0.99881528,-0.99873757,-0.99865740,-0.99857475,-0.99848965,-0.99840207,-0.99831203,-0.99821952,-0.99812455,-0.99802711,-0.99792721,-0.99782484,-0.99772001,-0.99761272,-0.99750296,-0.99739074,-0.99727605,-0.99715890};

THREAD_ENTRY() {
	THREAD_INIT();

	while (1) {
		ap_uint<32> data = ap_uint<32>((unsigned int)MBOX_GET(inverse_cmd));

		ap_uint<3> leg = data(2, 0);

		ap_int<10> t_p2b_ra_x = data(31, 22);
		ap_int<10> t_p2b_ra_y = data(21, 12);
		ap_fixed<10,2> t_p2b_ra_sin = sin_lut[data(11, 3)];
		ap_fixed<10,2> t_p2b_ra_cos = cos_lut[data(11, 3)];


		ap_fixed<12,10> p_b_j_x, p_b_j_y, p_b_j_z;
		ap_fixed<12,10> p_s_j_x, p_s_j_y, p_s_j_z;

		ap_fixed<12,10> v_s_aj_x, v_s_aj_y, v_s_aj_z;
		ap_fixed<22,20> v_s_aj_l, v_s_aj_l_min;
		ap_uint<TRIG_ADDR> v_s_aj_l_mina;


		// transform into base coordinatesystem
		// rotate around ra_x, ra_y, ra_z by ra_sin/ra_cos
		p_b_j_x =   (t_p2b_ra_x * t_p2b_ra_x * (1 - t_p2b_ra_cos) + 1          * t_p2b_ra_cos) * p_p_j_x[leg]
		          + (t_p2b_ra_x * t_p2b_ra_y * (1 - t_p2b_ra_cos) + 0          * t_p2b_ra_sin) * p_p_j_y[leg];
		p_b_j_y =   (t_p2b_ra_x * t_p2b_ra_y * (1 - t_p2b_ra_cos) - 0          * t_p2b_ra_sin) * p_p_j_x[leg]
		          + (t_p2b_ra_y * t_p2b_ra_y * (1 - t_p2b_ra_cos) + 1          * t_p2b_ra_cos) * p_p_j_y[leg];
		p_b_j_z =   (t_p2b_ra_x * 0          * (1 - t_p2b_ra_cos) + t_p2b_ra_y * t_p2b_ra_sin) * p_p_j_x[leg]
		          + (t_p2b_ra_y * 0          * (1 - t_p2b_ra_cos) - t_p2b_ra_x * t_p2b_ra_sin) * p_p_j_y[leg];

		// translate by t_Z
		p_b_j_z = p_b_j_z + t_p2b_t_z;


		// transform into servo coordinatesystem based on leg id
		// rotate around z axis by rz_sin/rz_cos
		p_s_j_x =  t_b2s_rz_cos[leg] * p_b_j_x + t_b2s_rz_sin[leg] * p_b_j_y + 0 * p_b_j_z;
		p_s_j_y = -t_b2s_rz_sin[leg] * p_b_j_x + t_b2s_rz_cos[leg] * p_b_j_y + 0 * p_b_j_z;
		p_s_j_z =  0                 * p_b_j_x + 0                 * p_b_j_y + 1 * p_b_j_z;

		// scale axis by s_x, s_y and s_z
		p_s_j_x = t_b2s_s_x[leg] * p_s_j_x;
		p_s_j_y = t_b2s_s_y[leg] * p_s_j_y;
		p_s_j_z = t_b2s_s_z[leg] * p_s_j_z;

		// translate by t_x, t_y and t_z
		p_s_j_x = p_s_j_x + t_b2s_t_x;
		p_s_j_y = p_s_j_y + t_b2s_t_y;
		p_s_j_z = p_s_j_z + t_b2s_t_z;


		// find angle for leg length
		v_s_aj_l_min = ap_fixed<22,20>("01111111111111111111", 2);
		for (int i = 0; i < TRIG_COUNT; i++) {
			// calculate vector from arm to joint
			v_s_aj_x = p_s_j_x - sin_lut[i] * c_arm;
			v_s_aj_y = p_s_j_y - 0;
			v_s_aj_z = p_s_j_z - cos_lut[i] * c_arm;
			v_s_aj_l = v_s_aj_x * v_s_aj_x + v_s_aj_y * v_s_aj_y + v_s_aj_z * v_s_aj_z;

			if (c_legs < v_s_aj_l) {
				if (v_s_aj_l - c_legs < v_s_aj_l_min) {
					v_s_aj_l_min = v_s_aj_l - c_legs;
					v_s_aj_l_mina = i;
				}
			} else {
				if (c_legs - v_s_aj_l < v_s_aj_l_min) {
					v_s_aj_l_min = c_legs - v_s_aj_l;
					v_s_aj_l_mina = i;
				}
			}
		}

		MBOX_PUT(servo_cmd, (v_s_aj_l_mina, leg, ap_uint<18>(0)));
	}
}